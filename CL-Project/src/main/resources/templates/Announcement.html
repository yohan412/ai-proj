<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Admin · User Control</title>
	
	<!--icon-->
	<link rel="icon" href="/images/profile/favicon.png" type="image/x-icon">
	
    <link rel="stylesheet" href="/css/topbar.css" />
    <link rel="stylesheet" href="/css/sidebar.css" />
    <link rel="stylesheet" href="/css/loginModal.css" />
    <link rel="stylesheet" href="/css/shareStyle.css" />
    <!-- Shared scripts -->
    <script src="/js/session.js"></script>
    <script src="/js/auth-fetch.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/topbar.js"></script>
    <script src="/js/loginModal.js"></script>
    <script src="/js/Announcement.js"></script>

    <!-- page-specific -->
    <link rel="stylesheet" href="/css/Announcement.css" />

    <!-- Client-side auth guard -->
    <script>
        if (!isLoggedIn()) {
            window.location.href = '/';
        }
    </script>
  
  </head>
  <body>
     <!-- Sidebar toggle button (hamburger icon) -->
  <div class="sidebar-toggle" onclick="toggleSidebar()">☰</div>

  <!-- Topbar fragment: login/profile/logout UI -->
  <div th:replace="~{fragments/topbar :: topbar}"></div>

  <!-- Login Modal fragment: login form dialog -->
  <div th:replace="~{fragments/loginModal :: loginModal}"></div>

  <!-- Left Sidebar fragment: navigation menu -->
  <div th:replace="~{fragments/sidebar :: sidebar}"></div> 

  <!-- ▣ 메인 콘텐츠 ▣ -->
  <div class="container">
    <h1 style="margin-bottom: 24px; color: #fff; font-weight: 700">
      Bulletin Board
    </h1>

    <div class="uc-wrapper glass-box">
      <!-- toolbar -->
      <div class="uc-toolbar">
        <div class="uc-search">
          <input type="text" id="ucSearch" placeholder="Search a post title..." />
        </div>
        <div class="uc-filters" id="ucfilters">
          <button class="uc-filter" id="uc-writeBtn">Registration</button>
        </div>
      </div>

      <!-- table -->
      <table>
        <thead>
          <tr>
            <th>No</th>
            <th>Title</th>
            <th>ID</th>
            <th>Date</th>
            <th>Count</th>
          </tr>
        </thead>
        <tbody id="ucTableBody">
          <!-- populated by JS -->
        </tbody>
      </table>
    </div>
      <!-- /uc-wrapper -->
    </div>
    <!-- /container -->

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const posts = [
        { no: "1", title: "강의1 업로드", id: "id1", date: "2025-07-01", count: 6 },
        { no: "2", title: "강의2 업로드", id: "id2", date: "2025-07-02", count: 7 },
        { no: "3", title: "강의3 업로드", id: "id3", date: "2025-07-03", count: 8 },
        { no: "4", title: "강의4 업로드", id: "id4", date: "2025-07-04", count: 9 },
        { no: "5", title: "강의5 업로드", id: "id5", date: "2025-07-05", count: 5 },
        ];

        const tableBody = document.getElementById("ucTableBody");
        const searchInput = document.getElementById("ucSearch");
        const postButton = document.getElementById("uc-writeBtn");

        // 게시글 등록 버튼 클릭 시 등록 페이지로 이동
        postButton?.addEventListener('click', () => {
        window.location.href = '/annRegistration';
        });
        
        function escapeHtml(text) {
            const div = document.createElement("div");
            div.textContent = text;
            return div.innerHTML;
          }
        // 게시글 렌더링 함수
        function renderPosts() {
        const keyword = searchInput.value.toLowerCase();
        tableBody.innerHTML = '';

        posts
            .filter(post => post.title.toLowerCase().includes(keyword))
            .forEach((post, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${post.no}</td>
                <td><a href="/postArticle?index=${index}" style="color: #fff;">${escapeHtml(post.title)}</a></td>
                <td>${post.id}</td>
                <td>${post.date}</td>
                <td>${post.count}</td>
              `;
              tableBody.appendChild(tr);
            });
        }

        // 검색 입력 시 필터링
        searchInput.addEventListener('input', renderPosts);

        // 초기 렌더링
        renderPosts();
    });
    </script>

  </body>
</html>
