<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Admin · postArticle</title>
  
  <!--icon-->
  <link rel="icon" href="/images/profile/favicon.png" type="image/x-icon">
  
  <link rel="stylesheet" href="/css/topbar.css" />
  <link rel="stylesheet" href="/css/sidebar.css" />
  <link rel="stylesheet" href="/css/loginModal.css" />
  <link rel="stylesheet" href="/css/shareStyle.css" />
  <!-- Shared scripts -->
  <script src="/js/session.js"></script>
  <script src="/js/auth-fetch.js"></script>
  <script src="/js/topbar.js"></script>    
  <script src="/js/sidebar.js"></script>
  <script src="/js/loginModal.js"></script>

  <!-- page-specific styles -->
  <link rel="stylesheet" href="/css/PostArticle.css" />
</head>

<body>
     <!-- Sidebar toggle button (hamburger icon) -->
  <div class="sidebar-toggle" onclick="toggleSidebar()">☰</div>

  <!-- Topbar fragment: login/profile/logout UI -->
  <div th:replace="~{fragments/topbar :: topbar}"></div>

  <!-- Login Modal fragment: login form dialog -->
  <div th:replace="~{fragments/loginModal :: loginModal}"></div>

  <!-- Left Sidebar fragment: navigation menu -->
  <div th:replace="~{fragments/sidebar :: sidebar}"></div> 

  <div class="container">
    <div class="glass-box">              
      <div class="board_title">
        <strong>POST</strong>
      </div>

      <div id="PostDetail" class="postDetail">
          <div id="number" class="postNumber"></div>
          <div id="title" class="postTitle"></div>
          <div id="writer" class="postWriter"></div> 
          <div id="date" class="postDate"></div> 
          <div id="views" class="postViews"></div>
          <div id="content" class="postContent">
            <div class="content-label">Content</div>
            <div class="content-box" id="contentText"></div>
          </div>
      </div>

      <div class="bt_wrap">
        <button id="backToMain">BACK</button>
      </div>
    </div>
  </div>

<!--   <script src="/js/PostArticle.js"></script> -->

<!--  Activation on local storage  --> 
  <script>
      // Demo data

    document.addEventListener('DOMContentLoaded', () => {
      const posts = [
        {number: 1, title: "강의1 업로드", writer: "id1", date:"2025-07-01", views: 1, content: " This is content1"},
        {number: 2, title: "강의2 업로드", writer: "id2", date:"2025-07-02", views: 1, content: "This is content2"},
        {number: 3, title: "강의3 업로드", writer: "id3", date:"2025-07-03", views: 1, content: "content3 is registered." },
        {number: 4, title: "강의4 업로드", writer: "id4", date:"2025-07-04", views: 1, content: "Hello. Here we are." },
        {number: 5, title: "강의5 업로드", writer: "id5", date:"2025-07-05", views: 1, content: "This is yours." },
      ];

      const backButton = document.getElementById('backToMain');
      const postNumber = document.getElementById('number');
      const postTitle = document.getElementById('title');
      const postWriter = document.getElementById('writer');
      const postDate = document.getElementById('date');
      const postViews = document.getElementById('views');
      const postContent = document.getElementById('content');
      const postContentText = document.getElementById('contentText');
      
      if (backButton) {
        backButton.addEventListener('click', () => {
          window.location.href = '/announcements';
        });
      }

      const params = new URLSearchParams(window.location.search);
      const index = parseInt(params.get('index'), 10);
      
      // local storage로 전환
      const storePosts = JSON.parse(localStorage.getItem('posts')) || posts;
      if (isNaN(index) || index < 0 || index >= storePosts.length) {
        postNumber.textContent = '';
        postTitle.textContent = '';
        postWriter.textContent = '';
        postDate.textContent = '';
        postViews.textContent = '';
        postContentText.textContent = '게시글을 찾을 수 없습니다.';
        return;
      }

      storePosts[index].views += 1;
      localStorage.setItem('posts', JSON.stringify(storePosts));

      const post = storePosts[index];
      
      postNumber.textContent = `No. ${post.number}`;
      postTitle.textContent = `Title: ${post.title}`;
      postWriter.textContent = `ID: ${post.writer}`;
      postDate.textContent = `Date: ${post.date}`;
      postViews.textContent = `View Count: ${post.views}`;
      postContentText.innerHTML = post.content;
      
    });
      
  </script>

  
</body>
</html>